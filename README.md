# goodeggs-mongoose-timestamps

Adds createdAt and updatedAt fields to any schema using Mongoose's built-in [timestamps schema option](http://mongoosejs.com/docs/guide.html#timestamps).

[![NPM version](http://img.shields.io/npm/v/goodeggs-mongoose-timestamps.svg?style=flat-square)](https://www.npmjs.org/package/goodeggs-mongoose-timestamps)
[![Build Status](http://img.shields.io/travis/goodeggs/goodeggs-mongoose-timestamps.svg?style=flat-square)](https://travis-ci.org/goodeggs/goodeggs-mongoose-timestamps)
[![MIT License](http://img.shields.io/badge/license-MIT-blue.svg?style=flat-square)](https://github.com/goodeggs/goodeggs-mongoose-timestamps/blob/master/LICENSE.md)

## Usage

```
npm install goodeggs-mongoose-timestamps
```

```coffee
timestamps = require 'goodeggs-mongoose-timestamps'

schema = new mongoose.Schema {}
schema.plugin timestamps
```

## Indexes

By default, it creates an index for `updatedAt` with spec `{updatedAt: 1}`. To override
this behavior:

```coffee
# Creates indexes for updatedAt by default
schema.plugin timestamps

# Does not create indexes
schema.plugin timestamps, createIndexes: false

# Only create createdAt index, descending order
schema.plugin timestamps, createIndexes: {createdAt: -1}
```

Note that it does not create an index on `createdAt`. An index on `createdAt` is redundant with the index already on `_id` which encodes the [document create time
in the first 4 bytes](https://docs.mongodb.com/manual/reference/bson-types/#objectid).

## Dependencies

This module does not pull in an other dependencies but does require that your application is using Mongoose 4.4.7 or greater. That was the version that first supported setting the `timestamps` option directly on the schema with `set` rather than in the schema constructor.

## Testing

To stub the values used to timestamp Mongoose objects, use [`sinon.useFakeTimers`](http://sinonjs.org/docs/#clock-api).

## Contributing

Please follow our [Code of Conduct](https://github.com/goodeggs/goodeggs-mongoose-timestamps/blob/master/CODE_OF_CONDUCT.md)
when contributing to this project.

```
$ git clone https://github.com/goodeggs/goodeggs-mongoose-timestamps && cd goodeggs-mongoose-timestamps
$ npm install
$ npm test
```

_Module scaffold generated by [generator-goodeggs-npm](https://github.com/goodeggs/generator-goodeggs-npm)._

## Releasing

For authorized authors:

```
git co master && git pull
npm version [major|minor|patch]
git push --follow-tags
npm publish
```
